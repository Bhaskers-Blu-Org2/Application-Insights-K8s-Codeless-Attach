environment:
  host:
    os: 'windows'
  runtime:
    provider: 'appcontainer'
    image: 'cdpxwin.azurecr.io/legacy/global/vse2017u5-external-azsdk-ext-win14393.1884:1.1-node10'
    source_mode: 'map'

version:
  name: 'AKSCodelessAttach'
  major: 0
  minor: 9
  tag: 'beta'
  system: 'custom'         # Must be one of patch, buildrevision, revisioncounter or custom. Other schemes can be added based on feedback.
  exclude_commit: true 
  
restore:
  commands:
    - !!defaultcommand
      name: 'Restore NPM packages for hook'
      command: '.build\src\restore.cmd'
  
build:
  commands:
    - !!buildcommand
      name: 'build hook source'
      command: '.build\src\build.cmd'
    - !!dockerbuildcommand
      name: 'build hook docker image'
      context_folder: 'src/'
      command: '.build\src\dockerbuild.cmd buildtests'
      repository_name: 'codeless-attach/mutating-webhook'
      publish_unique_tag: true
      publish: false
  